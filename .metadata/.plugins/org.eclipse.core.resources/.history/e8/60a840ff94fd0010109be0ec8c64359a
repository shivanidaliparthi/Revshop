package com.revshop.test;

import static org.junit.Assert.*;

import org.junit.Before;
import org.junit.Test;

import com.revshop.dao.UserDAO;
import com.revshop.model.User;

public class UserDAOTest {

    private UserDAO userDAO;

    @Before
    public void setUp() {
        userDAO = new UserDAO();
    }

    // ===============================
    // 1. USER REGISTRATION
    // ===============================

    @Test
    public void testAddUserSuccess() {
        User user = new User(1, "test@revshop.com", "pass123", "BUYER");
        boolean result = userDAO.addUser(user);
        assertTrue(result);
    }

    @Test
    public void testAddDuplicateUser() {
        User user1 = new User(1, "dup@revshop.com", "pass123", "BUYER");
        User user2 = new User(2, "dup@revshop.com", "newpass", "BUYER");

        userDAO.addUser(user1);
        boolean result = userDAO.addUser(user2);

        assertFalse(result);
    }

    // ===============================
    // 2. USER LOGIN
    // ===============================

    @Test
    public void testUserLoginSuccess() {
        User user = new User(1, "login@revshop.com", "pass123", "BUYER");
        userDAO.addUser(user);

        User dbUser = userDAO.getUserByEmail("login@revshop.com");

        assertNotNull(dbUser);
        assertEquals("pass123", dbUser.getPassword());
    }

    @Test
    public void testUserNotFound() {
        User dbUser = userDAO.getUserByEmail("nouser@revshop.com");
        assertNull(dbUser);
    }
}