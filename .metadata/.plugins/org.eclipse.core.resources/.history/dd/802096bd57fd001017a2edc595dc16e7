




package com.revshop.ui;

import java.util.Scanner;

import com.revshop.dao.UserDAO;
import com.revshop.model.User;
import com.revshop.service.BuyerService;
import com.revshop.service.SellerService;

public class MainApp {

    public static void main(String[] args) {

        Scanner sc = new Scanner(System.in);
        UserDAO userDAO = new UserDAO();

        BuyerService buyerService = new BuyerService();
        SellerService sellerService = new SellerService();

        int choice;

        do {
            System.out.println("\n===== REVSHOP =====");
            System.out.println("1. Register");
            System.out.println("2. Login");
            System.out.println("3. Forgot Password");
            System.out.println("4. Exit");

            choice = sc.nextInt();
            sc.nextLine();

            switch (choice) {

                case 1:
                    User user = new User();

                    System.out.print("Name: ");
                    user.setName(sc.nextLine());

                    System.out.print("Email: ");
                    user.setEmail(sc.nextLine());

                    System.out.print("Password: ");
                    user.setPassword(sc.nextLine());

                    System.out.print("Role (BUYER/SELLER): ");
                    user.setRole(sc.nextLine().toUpperCase());

                    System.out.print("Security Question: ");
                    user.setQuestion(sc.nextLine());

                    System.out.print("Answer: ");
                    user.setAnswer(sc.nextLine());

                    if (userDAO.register(user))
                        System.out.println("Registration successful");
                    else
                        System.out.println("User already exists");
                    break;

                case 2:
                    System.out.print("Email: ");
                    String email = sc.nextLine();

                    System.out.print("Password: ");
                    String pwd = sc.nextLine();

                    User loggedUser = userDAO.login(
                            email, pwd, userDAO.getRoleByEmail(email));

                    if (loggedUser != null) {
                        System.out.println("Welcome " + loggedUser.getName());

                        if ("BUYER".equalsIgnoreCase(loggedUser.getRole())) {
                            buyerService.buyerMenu(loggedUser, sc); // ✅ FIX
                        } else {
                            sellerService.sellerMenu(sc); // ✅ FIX
                        }
                    } else {
                        System.out.println("Invalid credentials");
                    }
                    break;

                case 3:
                    System.out.print("Email: ");
                    String em = sc.nextLine();

                    System.out.print("Security Question: ");
                    String ques = sc.nextLine();

                    System.out.print("Answer: ");
                    String ans = sc.nextLine();

                    System.out.print("New Password: ");
                    String np = sc.nextLine();

                    if (userDAO.forgotPassword(em, ques, ans, np))
                        System.out.println("Password updated successfully");
                    else
                        System.out.println("Wrong details");
                    break;

                case 4:
                    System.out.println("Thank you for using RevShop");
                    break;

                default:
                    System.out.println("Invalid choice");
            }

        } while (choice != 4);

        sc.close();
    }
}
































//package com.revshop.ui;
//
//
//
//import java.util.Scanner;
//import com.revshop.dao.*;
//import com.revshop.model.*;
//import com.revshop.service.BuyerService;
//import com.revshop.service.SellerService;
//
//public class main
//{
//
//    public static void main(String[] args) {
//
//        Scanner sc = new Scanner(System.in);
//        UserDAO userDAO = new UserDAO();
//        int choice;
//
//        do {
//            System.out.println("\n===== REVSHOP =====");
//            System.out.println("1. Register");
//            System.out.println("2. Login");
//            System.out.println("3. Forgot Password");
//            System.out.println("4. Exit");
//
//            choice = sc.nextInt();
//            sc.nextLine();
//
//            switch (choice) {
//
//                case 1:
//                    User user = new User();
//                    System.out.print("Name: ");
//                    user.setName(sc.nextLine());
//                    System.out.print("Email: ");
//                    user.setEmail(sc.nextLine());
//                    System.out.print("Password: ");
//                    user.setPassword(sc.nextLine());
//                    System.out.print("Role (BUYER/SELLER): ");
//                    user.setRole(sc.nextLine());
//
//                    if (user.getRole().equalsIgnoreCase("SELLER")) {
//                        System.out.print("Business Name: ");
//                        user.setBusinessName(sc.nextLine());
//                    }
//
//                    System.out.print("Security Question: ");
//                    user.setQuestion(sc.nextLine());
//                    System.out.print("Answer: ");
//                    user.setAnswer(sc.nextLine());
//
//                    if (userDAO.registerUser(user))
//                        System.out.println("Registration successful");
//                    else
//                        System.out.println("Registration failed");
//                    break;
//
//                case 2:
//                    System.out.print("Email: ");
//                    String email = sc.nextLine();
//                    System.out.print("Password: ");
//                    String pwd = sc.nextLine();
//
//                    User loggedUser = userDAO.login(email, pwd);
//                    if (loggedUser != null) {
//                        System.out.println("Welcome " + loggedUser.getName());
//                        if (loggedUser.getRole().equalsIgnoreCase("BUYER")) {
//                        	 new BuyerService.buyerMenu();
//                        } else {
//                            new SellerService().sellerMenu();
//                        }
//                    } else {
//                        System.out.println("Invalid credentials");
//                    }
//                    break;
//
//                case 3:
//                    System.out.print("Email: ");
//                    String em = sc.nextLine();
//                    System.out.print("Answer: ");
//                    String ans = sc.nextLine();
//                    System.out.print("New Password: ");
//                    String np = sc.nextLine();
//
//                    if (userDAO.forgotPassword(em, ans, np))
//                        System.out.println("Password updated");
//                    else
//                        System.out.println("Wrong details");
//                    break;
//
//                case 4:
//                    System.out.println("Thank you for using RevShop");
//                    break;
//            }
//        } while (choice != 4);
//    }
//}
//
//
//
//
//
////package com.revshop.ui;
////
////import com.revshop.dao.UserDAO;
////import com.revshop.model.User;
////import com.revshop.service.BuyerService;
////import com.revshop.service.SellerService;
////
////import java.util.Scanner;
////
////public class main {
////
////    public static void main(String[] args) {
////
////        Scanner sc = new Scanner(System.in);
////        UserDAO userDAO = new UserDAO();
////        BuyerService buyerService = new BuyerService();
////        SellerService sellerService = new SellerService();
////
////        System.out.println("1. Buyer Register");
////        System.out.println("2. Buyer Login");
////        System.out.println("3. Seller Login");
////
////        int choice = sc.nextInt();
////        sc.nextLine();
////
////        if (choice == 1) {
////            System.out.print("Name: ");
////            String name = sc.nextLine();
////            System.out.print("Email: ");
////            String email = sc.nextLine();
////            System.out.print("Password: ");
////            String pass = sc.nextLine();
////
////            userDAO.register(new User(
////                    userDAO.getNextId(), name, email, pass, "BUYER"));
////            System.out.println("Registered successfully");
////        }
////
////        if (choice == 2) {
////            System.out.print("Email: ");
////            String email = sc.nextLine();
////            System.out.print("Password: ");
////            String pass = sc.nextLine();
////
////            User buyer = userDAO.login(email, pass, "BUYER");
////            if (buyer != null)
////                buyerService.buyerMenu(buyer, sc);
////            else
////                System.out.println("Invalid credentials");
////        }
////
////        if (choice == 3) {
////            sellerService.sellerMenu(sc);
////        }
////    }
////}